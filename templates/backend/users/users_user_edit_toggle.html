{% extends 'backend/backend_base.html' %}
{% load widget_tweaks %}
{% block head %}
    <title>{{ user.get_full_name }} - Flis.no</title>
{% endblock head %}
{% block breadcrumb %}
    <a href="#" class="text-indigo-500">Home</a>
    <span class="text-gray-500">/</span>
    <a href="{% url 'users' %}" class="text-indigo-500">Users</a>
    <span class="text-gray-500">/</span>
    <a href="{% url 'user-detail' user.id %}" class="text-indigo-500">{{ user.get_full_name }}</a>
    <span class="text-gray-500">/</span>
    <a href="{% url 'user-detail-edit' user.id %}" class="text-indigo-500">Edit</a>
    <span class="text-gray-500">/</span>
    <a class="text-gray-500">Toggle {{ user.get_full_name }}</a>
{% endblock breadcrumb %}
{% block nav_users %}
    <a href="{% url 'users' %}" class="inline-flex items-center w-full px-5 py-2 pb-2 bg-gray-200">                   
        <svg class="w-4 h-4 mr-2" viewBox="0 0 14 14" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <g id="/backend" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="User-detail" transform="translate(-49.000000, -179.000000)">
                    <g id="nav" transform="translate(30.000000, 116.000000)">
                        <g id="user-icn" transform="translate(19.000000, 63.000000)">
                            <path d="M12.8388933,10.8623857 C12.2355094,9.80940676 11.1006001,9.8 9.8,9.8 L4.2,9.8 C2.89939988,9.8 1.76449058,9.80940676 1.16110669,10.8623857 C0.427352217,9.75537056 0,8.42759201 0,7 C0,3.13400675 3.13400675,1.50990331e-14 7,1.50990331e-14 C10.8659932,1.50990331e-14 14,3.13400675 14,7 C14,8.42759201 13.5726478,9.75537056 12.8388933,10.8623857 C11.5856026,12.753225 9.43840124,14 7,14 C4.56159876,14 2.41439742,12.753225 1.16110669,10.8623857 Z" id="Combined-Shape" fill="#C3DAFE"></path>
                            <path d="M1.16110669,10.8623857 C1.76449058,9.80940676 2.89939988,9.1 4.2,9.1 L9.8,9.1 C11.1006001,9.1 12.2355094,9.80940676 12.8388933,10.8623857 C11.5856026,12.753225 9.43840124,14 7,14 C4.56159876,14 2.41439742,12.753225 1.16110669,10.8623857 Z M7,7.7 C5.4536027,7.7 4.2,6.4463973 4.2,4.9 C4.2,3.3536027 5.4536027,2.1 7,2.1 C8.5463973,2.1 9.8,3.3536027 9.8,4.9 C9.8,6.4463973 8.5463973,7.7 7,7.7 Z" id="secondary" fill="#5A67D8"></path>
                        </g>
                    </g>
                </g>
            </g>
        </svg>
        <span class="text-base font-semibold text-indigo-500">Users</span>
    </a>
{% endblock nav_users %}
{% block content %}
    {% if not user.is_active %}
    <div class="bg-white w-full rounded shadow mb-5">
        <div class="py-5 px-5">
            <div class="inline-flex items-center">   
                <svg class="w-10 h-10 mr-2 xl:block lg:block md:hidden sm:hidden" viewBox="0 0 16 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <g id="icon-security-important" transform="translate(-4.000000, -2.000000)">
                            <path d="M4,4 L12,2 L20,4 L20,13.0557281 C20,16.0859046 18.287981,18.8560095 15.5777088,20.2111456 L12,22 L8.42229124,20.2111456 C5.71201901,18.8560095 4,16.0859046 4,13.0557281 L4,4 Z" id="primary" fill="#FED7D7"></path>
                            <path d="M12,18 C11.1715729,18 10.5,17.3284271 10.5,16.5 C10.5,15.6715729 11.1715729,15 12,15 C12.8284271,15 13.5,15.6715729 13.5,16.5 C13.5,17.3284271 12.8284271,18 12,18 Z M12.9948752,12.0995037 C12.8748168,13.3001654 11.1249884,13.3001654 11.00493,12.0995037 L10.5049625,7.09950372 C10.4460977,6.5108179 10.9083516,6 11.4999351,6 L12.4998701,6 C13.0914536,6 13.5537075,6.5108179 13.4948427,7.09950372 L12.9948752,12.0995037 Z" id="secondary" fill="#9B2C2C"></path>
                        </g>
                    </g>
                </svg>
                <div class="flex-wrap">
                    <h1 class="block text-base font-semibold text-red-700 -mb-1">User has been deactivated!</h1>
                    <span class="block text-sm text-gray-800">This user has been deactivated. Reason is normally stated in the notes. User can be reactivated with the appropriate permission.</span>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    <!--User overview-->
    <div class="bg-white w-full rounded shadow">
        <div class="flex justify-between items-center border-b border-solid border-gray-300 px-5 py-5">
            <div class="inline-flex items-center">           
                <svg class="w-10 h-10 mr-2" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <g id="/backend" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <g id="User-detail" transform="translate(-279.000000, -131.000000)">
                            <g id="overview" transform="translate(261.000000, 116.000000)">
                                <g id="Main-data" transform="translate(0.000000, 15.000000)">
                                    <g id="user-icn" transform="translate(18.000000, 0.000000)">
                                        <path d="M36.6825523,31.0353877 C34.9585983,28.0268764 31.7160003,28 28,28 L12,28 C8.28399965,28 5.04140167,28.0268764 3.3174477,31.0353877 C1.22100633,27.8724873 0,24.0788343 0,20 C0,8.954305 8.954305,1.50990331e-14 20,1.50990331e-14 C31.045695,1.50990331e-14 40,8.954305 40,20 C40,24.0788343 38.7789937,27.8724873 36.6825523,31.0353877 C33.1017216,36.4377857 26.9668607,40 20,40 C13.0331393,40 6.89827835,36.4377857 3.3174477,31.0353877 Z" id="Combined-Shape" fill="#A5B3BB"></path>
                                        <path d="M3.3174477,31.0353877 C5.04140167,28.0268764 8.28399965,26 12,26 L28,26 C31.7160003,26 34.9585983,28.0268764 36.6825523,31.0353877 C33.1017216,36.4377857 26.9668607,40 20,40 C13.0331393,40 6.89827835,36.4377857 3.3174477,31.0353877 Z M20,22 C15.581722,22 12,18.418278 12,14 C12,9.581722 15.581722,6 20,6 C24.418278,6 28,9.581722 28,14 C28,18.418278 24.418278,22 20,22 Z" id="secondary" fill="#0D2B3E"></path>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </g>
                </svg>
                <div class="flex-wrap">
                    <h1 class="block text-base font-semibold text-gray-800 -mb-1">{{ user.get_full_name }}</h1>
                    <span class="block text-sm text-gray-500">{{ user.roles.all.0 }}</span>
                </div>
            </div>
            <div>
                <a href="{% url 'user-detail-export' user.id %}" class="text-indigo-500 font-semibold hover:text-indigo-700">Export</a>
                <button href="#" class="add-note-btn text-indigo-500 font-semibold hover:text-indigo-700 ml-3">Add note</button>
                <form class="inline-flex" action="/hijack/{{ user.id }}/" method="POST">
                    {% csrf_token %}
                    <button type="submit" class="bg-transparent hover:bg-indigo-500 text-indigo-500 hover:text-white font-semibold py-1 px-3 border border-indigo-500 hover:border-transparent rounded ml-3">Hijack</button>
                </form>
            </div>
        </div>
        <div class="add-note-field hidden py-5 px-5 border-b border-solid border-gray-300">
            <form method="POST">
                {% csrf_token %}
                {{ note_form.content|attr:"rows:4"|attr:"placeholder:Add a note..."|add_class:"w-full bg-gray-200 text-gray-700 rounded py-3 px-4 leading-tight focus:outline-none focus:border-gray-300" }}
                <div class="flex justify-between">
                    <label>
                        {{ note_form.is_sticky }}
                        <span class="ml-1 text-sm text-gray-900">Pin to top</span>
                    </label>
                    <div class="flex">
                        <button class="add-note-cancel-btn text-gray-500 font-semibold hover:text-gray-700 mr-3">Cancel</button>
                        <button name="make-note-btn" type="submit" class="bg-indigo-500 hover:bg-indigo-700 text-white hover:text-white font-semibold py-1 px-3 border border-indigo-500 hover:border-transparent rounded">Add note</button>
                    </div>
                </div>
            </form>        
        </div>
        <div class="notes-container">
        {% for note in notes %}
            {% if note.is_sticky %}
            <div class="bg-gray-200 flex justify-between items-center border-b border-solid border-gray-300 py-5 px-5">
                <div class="inline-flex">                           
                    <svg class="w-4 h-4 mt-1 mr-2" viewBox="0 0 14 14" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g id="/backend" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="User-detail" transform="translate(-279.000000, -201.000000)">
                                <g id="overview" transform="translate(261.000000, 116.000000)">
                                    <g id="note1" transform="translate(0.000000, 73.000000)">
                                        <g id="Group-3" transform="translate(18.000000, 12.000000)">
                                            <path d="M0.171997789,12.2313828 L4.50533112,7.23138281 C4.75872034,6.93901063 5.20695243,6.92302271 5.48052836,7.19659865 L6.14719503,7.86326532 C6.42077097,8.13684125 6.40478305,8.58507334 6.11241087,8.83846256 L1.11241087,13.1717959 C0.486956099,13.7138567 -0.370063012,12.8568376 0.171997789,12.2313828 Z" id="secondary" fill="#5A67D8"></path>
                                            <path d="M8.67579051,8.94414554 L8.67579051,10.6680032 C8.67579051,10.8448142 8.60555262,11.0143834 8.48052836,11.1394077 L7.8138617,11.8060744 C7.55351217,12.0664239 7.13140218,12.0664239 6.87105266,11.8060744 L1.53771932,6.47274102 C1.2773698,6.2123915 1.2773698,5.79028151 1.53771932,5.52993198 L2.20438599,4.86326532 C2.32941024,4.73824106 2.49897952,4.66800317 2.67579051,4.66800317 L4.39964814,4.66800317 L7.34245718,1.72519413 L7.34245718,0.66800317 C7.34245718,0.0740666027 8.06055179,-0.223377925 8.48052836,0.196598649 L13.147195,4.86326532 C13.5671716,5.28324189 13.2697271,6.0013365 12.6757905,6.0013365 L11.6185996,6.0013365 L8.67579051,8.94414554 Z" id="primary" fill="#C3DAFE"></path>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>
                    <div class="flex-wrap">
                        <p class="text-base text-gray-800">{{ note.content }}</p>
                        <span class="block text-xs text-gray-500">{{ note.date_edited }}<span class="tracking-wider"> • </span>{{ note.author }}</span>
                    </div>
                </div>
                <div class="flex">
                    <form method="GET">
                        <button name="pin-note-btn" value="{{ note.id }}" type="submit">
                            <svg class="h-4 w-4 mr-3" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <g id="icon-pin" transform="translate(-2.000000, -2.000000)">
                                        <path d="M2.24431092,20.3450695 L8.74431092,12.8450695 C9.12439475,12.4065112 9.79674288,12.3825293 10.2071068,12.7928932 L11.2071068,13.7928932 C11.6174707,14.2032571 11.5934888,14.8756053 11.1549305,15.2556891 L3.65493054,21.7556891 C2.71674838,22.5687803 1.43121972,21.2832516 2.24431092,20.3450695 Z" id="secondary" fill="#0D2B3E"></path>
                                        <path d="M15,15.4142136 L15,18 C15,18.2652165 14.8946432,18.5195704 14.7071068,18.7071068 L13.7071068,19.7071068 C13.3165825,20.0976311 12.6834175,20.0976311 12.2928932,19.7071068 L4.29289322,11.7071068 C3.90236893,11.3165825 3.90236893,10.6834175 4.29289322,10.2928932 L5.29289322,9.29289322 C5.4804296,9.10535684 5.73478351,9 6,9 L8.58578644,9 L13,4.58578644 L13,3 C13,2.10909515 14.0771419,1.66292836 14.7071068,2.29289322 L21.7071068,9.29289322 C22.3370716,9.92285808 21.8909049,11 21,11 L19.4142136,11 L15,15.4142136 Z" id="primary" fill="#A5B3BB"></path>
                                    </g>
                                </g>
                            </svg>
                        </button>
                    </form>
                    <form method="GET">
                        <button name="delete-note-btn" value="{{ note.id }}" type="submit">
                            <svg class="h4 w-4" viewBox="0 0 16 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <g id="icon-trash" transform="translate(-4.000000, -2.000000)">
                                        <path d="M5,5 L19,5 L18.1107386,20.117444 C18.0485547,21.1745693 17.1731425,22 16.1141898,22 L7.88581016,22 C6.82685754,22 5.95144525,21.1745693 5.88926141,20.117444 L5,5 Z M10,10 C9.44771525,10 9,10.4477153 9,11 L9,17 C9,17.5522847 9.44771525,18 10,18 C10.5522847,18 11,17.5522847 11,17 L11,11 C11,10.4477153 10.5522847,10 10,10 Z M14,10 C13.4477153,10 13,10.4477153 13,11 L13,17 C13,17.5522847 13.4477153,18 14,18 C14.5522847,18 15,17.5522847 15,17 L15,11 C15,10.4477153 14.5522847,10 14,10 Z" id="primary" fill="#A5B3BB"></path>
                                        <path d="M8.58578644,4 L10.2928932,2.29289322 C10.4804296,2.10535684 10.7347835,2 11,2 L13,2 C13.2652165,2 13.5195704,2.10535684 13.7071068,2.29289322 L15.4142136,4 L19,4 C19.5522847,4 20,4.44771525 20,5 C20,5.55228475 19.5522847,6 19,6 L5,6 C4.44771525,6 4,5.55228475 4,5 C4,4.44771525 4.44771525,4 5,4 L8.58578644,4 Z" id="secondary" fill="#0D2B3E"></path>
                                    </g>
                                </g>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
            {% else %}
            <div class="normal-note flex justify-between items-center border-b border-solid border-gray-300 py-5 px-5">
                <div class="inline-flex">                                                    
                    <svg class="w-4 h-4 mt-1 mr-2" viewBox="0 0 12 14" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g id="/backend" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="User-detail" transform="translate(-279.000000, -253.000000)">
                                <g id="overview" transform="translate(261.000000, 116.000000)">
                                    <g id="note2" transform="translate(0.000000, 137.000000)">
                                        <g id="note-icn" transform="translate(18.000000, 0.000000)">
                                            <path d="M1.4,0 L5.6,0 L5.6,4.2 C5.6,4.97319865 6.22680135,5.6 7,5.6 L11.2,5.6 L11.2,12.6 C11.2,13.3731986 10.5731986,14 9.8,14 L1.4,14 C0.62680135,14 0,13.3731986 0,12.6 L0,1.4 C0,0.62680135 0.62680135,0 1.4,0 Z" id="primary" fill="#A5B3BB"></path>
                                            <polygon id="secondary" fill="#0D2B3E" points="7 0 11.2 4.2 7 4.2"></polygon>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>
                    <div class="flex-wrap">
                        <p class="text-base text-gray-800">{{ note.content }}</p>
                        <span class="block text-xs text-gray-500">{{ note.date_edited }}<span class="tracking-wider"> • </span>{{ note.author }}</span>
                    </div>
                </div>
                <div class="flex">
                    <form method="GET">
                        <button name="pin-note-btn" value="{{ note.id }}" type="submit">
                            <svg class="h-4 w-4 mr-3" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <g id="icon-pin" transform="translate(-2.000000, -2.000000)">
                                        <path d="M2.24431092,20.3450695 L8.74431092,12.8450695 C9.12439475,12.4065112 9.79674288,12.3825293 10.2071068,12.7928932 L11.2071068,13.7928932 C11.6174707,14.2032571 11.5934888,14.8756053 11.1549305,15.2556891 L3.65493054,21.7556891 C2.71674838,22.5687803 1.43121972,21.2832516 2.24431092,20.3450695 Z" id="secondary" fill="#0D2B3E"></path>
                                        <path d="M15,15.4142136 L15,18 C15,18.2652165 14.8946432,18.5195704 14.7071068,18.7071068 L13.7071068,19.7071068 C13.3165825,20.0976311 12.6834175,20.0976311 12.2928932,19.7071068 L4.29289322,11.7071068 C3.90236893,11.3165825 3.90236893,10.6834175 4.29289322,10.2928932 L5.29289322,9.29289322 C5.4804296,9.10535684 5.73478351,9 6,9 L8.58578644,9 L13,4.58578644 L13,3 C13,2.10909515 14.0771419,1.66292836 14.7071068,2.29289322 L21.7071068,9.29289322 C22.3370716,9.92285808 21.8909049,11 21,11 L19.4142136,11 L15,15.4142136 Z" id="primary" fill="#A5B3BB"></path>
                                    </g>
                                </g>
                            </svg>
                        </button>
                    </form>
                    <form method="GET">
                        <button name="delete-note-btn" value="{{ note.id }}" type="submit">
                            <svg class="h4 w-4" viewBox="0 0 16 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <g id="icon-trash" transform="translate(-4.000000, -2.000000)">
                                        <path d="M5,5 L19,5 L18.1107386,20.117444 C18.0485547,21.1745693 17.1731425,22 16.1141898,22 L7.88581016,22 C6.82685754,22 5.95144525,21.1745693 5.88926141,20.117444 L5,5 Z M10,10 C9.44771525,10 9,10.4477153 9,11 L9,17 C9,17.5522847 9.44771525,18 10,18 C10.5522847,18 11,17.5522847 11,17 L11,11 C11,10.4477153 10.5522847,10 10,10 Z M14,10 C13.4477153,10 13,10.4477153 13,11 L13,17 C13,17.5522847 13.4477153,18 14,18 C14.5522847,18 15,17.5522847 15,17 L15,11 C15,10.4477153 14.5522847,10 14,10 Z" id="primary" fill="#A5B3BB"></path>
                                        <path d="M8.58578644,4 L10.2928932,2.29289322 C10.4804296,2.10535684 10.7347835,2 11,2 L13,2 C13.2652165,2 13.5195704,2.10535684 13.7071068,2.29289322 L15.4142136,4 L19,4 C19.5522847,4 20,4.44771525 20,5 C20,5.55228475 19.5522847,6 19,6 L5,6 C4.44771525,6 4,5.55228475 4,5 C4,4.44771525 4.44771525,4 5,4 L8.58578644,4 Z" id="secondary" fill="#0D2B3E"></path>
                                    </g>
                                </g>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
            {% endif %}
        {% endfor %}
        </div>
        <div class="show-more-notes-container flex justify-center items-center py-5 px-5">
            <button class="show-more-notes text-indigo-500 font-semibold">Show more</button>
        </div>
    </div>
    <!--User overview end-->
    <!--User edit-->
    <div class="bg-white w-full rounded shadow mt-5">
        <div class="flex items-center border-b border-solid border-gray-300 py-5 px-5">
            {% if user.is_active %}
            <h2 class="text-base font-semibold text-gray-800">Deactivate "{{ user.get_full_name }}"</h2>
            {% else %}
            <h2 class="text-base font-semibold text-gray-800">Reactivate "{{ user.get_full_name }}"</h2>
            {% endif %}
        </div>
        <div class="py-5 px-5">
            <div class="w-full">
                {% if not user.is_active %}
                <span class="mt-2 text-base text-gray-600">Are you sure that you want to reactivate the user?</span>
                {% else %}
                <span class="mt-2 text-base text-gray-600">Are you sure that you want to deacticate the user?</span>
                {% endif %}
                <div class="flex items-center">
                    <form method="POST" id="user-toggle-form">
                        {% csrf_token %}
                        {% if user.is_active %}
                            <button form="user-toggle-form" class="mt-2 bg-white hover:bg-red-500 border border-red-500 hover:border-red-500 rounded py-1 px-2 font-semibold text-red-500 hover:text-white" name="user-toggle-btn" type="submit">Deactivate account</button>
                        {% else %}
                            <button form="user-toggle-form" class="mt-2 bg-white hover:bg-indigo-500 border border-indigo-500 hover:border-indigo-500 rounded py-1 px-2 font-semibold text-indigo-500 hover:text-white" name="user-toggle-btn" type="submit">Reactivate account</button>
                        {% endif %}
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!--User information end-->
{% endblock content %}